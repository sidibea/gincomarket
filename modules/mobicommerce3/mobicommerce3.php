<?php
$GLOBALS["DWmsYJsvcfBZEyObOnZU"]=base64_decode("aHR0cHM6Ly8=");$GLOBALS["JMxuLHVopMBOTWBgwTul"]=base64_decode("aHR0cDovLw==");$GLOBALS["POWdsDYcgiVnFFDSbMHA"]=base64_decode("UFNfU1NMX0VOQUJMRURfRVZFUllXSEVSRQ==");$GLOBALS["tYnFWBeUsqckcNNWjtX"]=base64_decode("UFNfU1NMX0VOQUJMRUQ=");$GLOBALS["zFaAqVHyRzYZHEQUxFJK"]=base64_decode("L3NxbC91bmluc3RhbGwucGhw");$GLOBALS["bJVDJcBfjwWDhPgYNynR"]=base64_decode("aWRfY2FydF9ydWxl");$GLOBALS["tWEpgXkrLAXowzZKvcbz"]=base64_decode("c2NvcGU=");$GLOBALS["kILHyWrKplYlLeXaggxX"]=base64_decode("bWV0aG9k");$GLOBALS["BEXrRczpGGDZJAJMnsjD"]=base64_decode("dmlld3MvY3NzL2Zyb250L3N0eWxlLmNzcw==");$GLOBALS["kZQSYIKWnOeNngRGKIox"]=base64_decode("YWxs");$GLOBALS["gHJMNXPHqnNzVOGjUFmc"]=base64_decode("dmlld3MvY3NzL2FkbWluL21vYmlhZG1pbi5jc3M=");$GLOBALS["zhUvaCEjrllOIalDbnUv"]=base64_decode("ZGlzcGxheUhlYWRlcg==");$GLOBALS["igZOvvDlBZQywxZVIpEA"]=base64_decode("YWN0aW9uRnJvbnRDb250cm9sbGVyU2V0TWVkaWE=");$GLOBALS["GGPikPaomBRwzmHgnBHE"]=base64_decode("YWN0aW9uQWRtaW5Db250cm9sbGVyU2V0TWVkaWE=");$GLOBALS["djUHgAUBPKdarJcYpGng"]=base64_decode("Mg==");$GLOBALS["uWKFXgKiJnKuctSLxHZU"]=base64_decode("bW9iaTNfZ29fc29ydG9yZGVy");$GLOBALS["RAtCBlhDFJOdHhPkM"]=base64_decode("MjA6NTU6MDU6MTE6RDA6M0Q6QjY6MUI6RkY6Nzk6M0Q6MDI6MUU6OTE6N0I6MUI6NjY6NjA6MUM6REE=");$GLOBALS["tNodlJSOgQKITyGtLBI"]=base64_decode("bW9iaTNfZ29fc2hhMWtleQ==");$GLOBALS["fnGsWtXHbmMyXVDZPegk"]=base64_decode("ODgxMzA2NTg0Nzc0LWduMTc1cHEyb3A4dGduMmZjMTI1czM4aGhvNDhrMjZrLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29t");$GLOBALS["OhaGrjJEvXfbGMPhtwAi"]=base64_decode("bW9iaTNfZ29fY2xpZW50aWQ=");$GLOBALS["GTWxKNeocNBkgCRHHfJY"]=base64_decode("TG9naW4gd2l0aCBHb29nbGU=");$GLOBALS["JSWXjmnVIKELCLTICatu"]=base64_decode("bW9iaTNfZ29fdGl0bGU=");$GLOBALS["lGWynakxWzWumZgCwVDV"]=base64_decode("bW9iaTNfZ29fYWN0aXZl");$GLOBALS["tTowgAFKukoxUTRKPRxI"]=base64_decode("bW9iaTNfZmJfc29ydG9yZGVy");$GLOBALS["LdYUYYzSXzgfyUXDNKWg"]=base64_decode("TW9iaUNvbW1lcmNlIERlbW8=");$GLOBALS["TdRXiZXqEHgBuseUVqEz"]=base64_decode("bW9iaTNfZmJfYXBwbmFtZQ==");$GLOBALS["EsvxraIFYmkdylZgGmMX"]=base64_decode("NDA4OTI4NzM2MTIwNzg0");$GLOBALS["FZUODXfvLjMLyWVrxINb"]=base64_decode("bW9iaTNfZmJfYXBwaWQ=");$GLOBALS["PJYmzfAXOgfQEzafjvBl"]=base64_decode("TG9naW4gd2l0aCBGYWNlYm9vaw==");$GLOBALS["ZjfFSusTFBIeqZzXPINl"]=base64_decode("bW9iaTNfZmJfdGl0bGU=");$GLOBALS["SHlRCNLzGtCGyHhhetLl"]=base64_decode("MQ==");$GLOBALS["zMPvYzoLdRkgowqPiwuh"]=base64_decode("bW9iaTNfZmJfYWN0aXZl");$GLOBALS["pGhAtrfjJwrPAFNrUqNl"]=base64_decode("TUNMYWJlbHM=");$GLOBALS["WarxExPCelIObaLZIjaC"]=base64_decode("TUNDYXRlZ29yeVdpZGdldA==");$GLOBALS["VvHslNbZSVSKvvmuhbbG"]=base64_decode("TUNTb2NpYWxMb2dpbg==");$GLOBALS["OSmDzfWeKRJaCEzlcEMc"]=base64_decode("TUNNYW5hZ2VBcHA=");$GLOBALS["kYpgutLcGQuHODngFFHY"]=base64_decode("TUNOZXdBcHA=");$GLOBALS["UYdJKOTlFstOMUXlzpeP"]=base64_decode("QWRtaW5Nb2JpY29tbWVyY2Uz");$GLOBALS["waWafEeALmeXuRDBxZD"]=base64_decode("aWRfbGFuZw==");$GLOBALS["irJwmSzLsAjXnTJypFuS"]=base64_decode("L3NxbC9pbnN0YWxsLnBocA==");$GLOBALS["gvOTCzaPsEwEOkNnGBQG"]=base64_decode("bGljZW5jZV9rZXk=");$GLOBALS["VtyabxBAjoNAXBjDoqxy"]=base64_decode("ZGF0YQ==");$GLOBALS["bratZqEHcANkTLFjisMP"]=base64_decode("aHR0cDovL2J1aWxkMy5idWlsZC5tb2JpLWNvbW1lcmNlLm5ldC9pbnN0YWxs");$GLOBALS["lIGIPNutSLeUnwPqc"]=base64_decode("cHJlc3Rhc2hvcA==");$GLOBALS["VleCnkvKIYrZfptPiSKI"]=base64_decode("cGxhdGZvcm0=");$GLOBALS["mrYkxwAvScQSssyfGPpw"]=base64_decode("Y291bnRyeQ==");$GLOBALS["lZlhSyWuvgybUryqeBno"]=base64_decode("YWRtaW5fZW1haWw=");$GLOBALS["AqhqVTHIInqnsrgGonun"]=base64_decode("c2FsZXNfZW1haWw=");$GLOBALS["NknlijAUkroIGaldujVA"]=base64_decode("d2Vic2l0ZV91cmw=");$GLOBALS["tugkmwKQmrdyfghQnRJj"]=base64_decode("");$GLOBALS["MgJrVVxdfXLqLDQMaSnz"]=base64_decode("QXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIHVuaW5zdGFsbD8=");$GLOBALS["PlMIiOdaIwcSLByTwLpK"]=base64_decode("bWF4");$GLOBALS["bcMeQJBFBAERaPoJTbk"]=base64_decode("MS41");$GLOBALS["mADcDrPgLtOqLDssenuj"]=base64_decode("bWlu");$GLOBALS["WcjGqYQLsndqcgkOWlOu"]=base64_decode("bW9iaWxl");$GLOBALS["NAVDPgeLXzpvsVgHECI"]=base64_decode("ODlhODA4MmE0ZWJiZmI2NDM5MmJiOGZiYWMyZDcxOTc=");$GLOBALS["ZXXDFSHkWkCLSAwatcM"]=base64_decode("My4wLjA=");$GLOBALS["tJbREhYgPKbawrEFNJWU"]=base64_decode("TW9iaUNvbW1lcmNl");$GLOBALS["lVkDpJCdRrqksaxQsULO"]=base64_decode("Q3JlYXRlIE1vYmlsZSBOYXRpdmUgaU9TICYgQW5kcm9pZCBhcHBzIGFuZCBNb2JpbGUgd2Vic2l0ZSBmb3IgeW91ciBtYWdlbnRvIHN0b3JlLiBBbGwgeW91IGNhbiBkbyB0aHJvdWdoIE1hZ2V0byBhZG1pbi4KCQkJUHJldmlldyBhbmQgdGVzdCB5b3VyIG1vYmlsZSBhcHBzIGFuZCBtb2JpbGUgd2Vic2l0ZSBiZWZvcmUgeW91IGJ1eSBpdC4KCQkJUGVyc29uYWxpemUgYW5kIGN1c3RvbWl6ZSB5b3VyIGFwcHMgb24gdGhlIGZseS4KCQkJU2VuZCBQdXNoIG5vdGlmaWNhdGlvbiB0byBhbGwgb2YgeW91ciBtb2JpbGUgdXNlci4KCQkJTm8gY29kaW5nIGFuZCB0ZWNobmljYWwgc2tpbGxzIHJlcXVpcmVkIHRvIGNyZWF0ZSBhbmQgbWFuYWdlIHlvdXIgbW9iaWxlIGFwcHMuCgkJCSAgICBDcmVhdGUgTW9iaWxlIE5hdGl2ZSBpT1MgJiBBbmRyb2lkIGFwcHMgYW5kIE1vYmlsZSB3ZWJzaXRlIGZvciB5b3VyIG1hZ2VudG8gc3RvcmUuIEFsbCB5b3UgY2FuIGRvIHRocm91Z2ggTWFnZXRvIGFkbWluLgoJCQlQcmV2aWV3IGFuZCB0ZXN0IHlvdXIgbW9iaWxlIGFwcHMgYW5kIG1vYmlsZSB3ZWJzaXRlIGJlZm9yZSB5b3UgYnV5IGl0LgoJCQlQZXJzb25hbGl6ZSBhbmQgY3VzdG9taXplIHlvdXIgYXBwcyBvbiB0aGUgZmx5LgoJCQlTZW5kIFB1c2ggbm90aWZpY2F0aW9uIHRvIGFsbCBvZiB5b3VyIG1vYmlsZSB1c2VyLgoJCQlObyBjb2RpbmcgYW5kIHRlY2huaWNhbCBza2lsbHMgcmVxdWlyZWQgdG8gY3JlYXRlIGFuZCBtYW5hZ2UgeW91ciBtb2JpbGUgYXBwcy4=");$GLOBALS["uKzifODWsLfOCSmhxPoW"]=base64_decode("TW9iaUNvbW1lcmNlIDMuMA==");$GLOBALS["fSbNHvNbXyTVCvrycbvJ"]=base64_decode("bW9iaWNvbW1lcmNlMw==");$GLOBALS["sAQEXilAsHTxRRtWAHnp"]=base64_decode("X1BTX1ZFUlNJT05f");$GLOBALS["gYWazQYeLzDgqzSKpMZE"]=base64_decode("TGFibGVzIGFuZCBNZXNzYWdlcw==");$GLOBALS["UFQFxmkPNbrGHCWclpiO"]=base64_decode("Q2F0ZWdvcnkgV2lkZ2V0cw==");$GLOBALS["nNkRavYhaVrzsLPAzg"]=base64_decode("U29jaWFsIExvZ2lu");$GLOBALS["JAIrBbYDhLJQVgIDPjgw"]=base64_decode("TWFuYWdlIE1vYmlsZSBBcHBz");$GLOBALS["kXZbhPBOUmfTivXNaSqo"]=base64_decode("Q3JlYXRlIE5ldyBNb2JpbGUgQXBw");
?><?php


if (!defined($GLOBALS["sAQEXilAsHTxRRtWAHnp"]))
	exit;

class Mobicommerce3 extends Module
{
	
	public function __construct()
	{
		$this->name = $GLOBALS["fSbNHvNbXyTVCvrycbvJ"];
		$this->displayName = $GLOBALS["uKzifODWsLfOCSmhxPoW"];
		$this->description = $this->l($GLOBALS["lVkDpJCdRrqksaxQsULO"]);
		$this->author = $GLOBALS["tJbREhYgPKbawrEFNJWU"];
		$this->version = $GLOBALS["ZXXDFSHkWkCLSAwatcM"];
		$this->module_key = $GLOBALS["NAVDPgeLXzpvsVgHECI"];
		$this->tab = $GLOBALS["WcjGqYQLsndqcgkOWlOu"];
        $this->ps_versions_compliancy = array('min' => '1.5', 'max' => _PS_VERSION_);
        $this->bootstrap = true;
        
        $this->confirmUninstall = $this->l($GLOBALS["MgJrVVxdfXLqLDQMaSnz"]);
				parent::__construct();
   }

	public function install()
	{
		
		$context = context::getContext();
	    $website_url  = $this->getBaseURL();
	    $sales_email  = $context->cookie->email;
	    $country      = $GLOBALS["tugkmwKQmrdyfghQnRJj"];

	    $curlData = array();
	    $curlData['website_url'] = $website_url;
	    $curlData['sales_email'] = $sales_email;
	    $curlData['admin_email'] = $context->cookie->email;
	    $curlData['country'] = $country;
	    $curlData['platform'] = 'prestashop';
	    $fields_string = http_build_query($curlData);

	    $ch = curl_init();
	    $url = $GLOBALS["bratZqEHcANkTLFjisMP"];
	    curl_setopt($ch, CURLOPT_HEADER, FALSE);
	    curl_setopt($ch, CURLOPT_NOBODY, TRUE);
	    curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
	    curl_setopt($ch, CURLOPT_URL, $url);
	    curl_setopt($ch, CURLOPT_POST, count($curlData));
	    curl_setopt($ch, CURLOPT_POSTFIELDS, $fields_string);
	    $result = curl_exec($ch);
	    curl_close($ch);  

	    $result = Tools::jsonDecode($result, true);
	    $licence_key = $result[$GLOBALS["VtyabxBAjoNAXBjDoqxy"]][$GLOBALS["gvOTCzaPsEwEOkNnGBQG"]];
	    
	    
				include(_PS_MODULE_DIR_.$this->name.$GLOBALS["irJwmSzLsAjXnTJypFuS"]);
		$sql = getSql($licence_key);
		foreach ($sql as $s) {
			if (!Db::getInstance()->execute($s))
			return false;
		}

			  	$tab = new Tab();
		foreach (Language::getLanguages() as $lang) {
			$tab->name[$lang[$GLOBALS["waWafEeALmeXuRDBxZD"]]] = $this->l($GLOBALS["uKzifODWsLfOCSmhxPoW"]);
		}
	
		$tab->class_name = $GLOBALS["UYdJKOTlFstOMUXlzpeP"];
        $tab->id_parent = 0;
		$tab->module = $this->name;
		$tab->add();
        $parentId = $tab->id;
        
        $this->installModuleTab($GLOBALS["kYpgutLcGQuHODngFFHY"], $GLOBALS["kXZbhPBOUmfTivXNaSqo"], $parentId);
        $this->installModuleTab($GLOBALS["OSmDzfWeKRJaCEzlcEMc"], $GLOBALS["JAIrBbYDhLJQVgIDPjgw"], $parentId);
        $this->installModuleTab($GLOBALS["VvHslNbZSVSKvvmuhbbG"], $GLOBALS["nNkRavYhaVrzsLPAzg"], $parentId);
        $this->installModuleTab($GLOBALS["WarxExPCelIObaLZIjaC"], $GLOBALS["UFQFxmkPNbrGHCWclpiO"], $parentId);
        $this->installModuleTab($GLOBALS["pGhAtrfjJwrPAFNrUqNl"], $GLOBALS["gYWazQYeLzDgqzSKpMZE"], $parentId);
                
        Configuration::updateValue($GLOBALS["zMPvYzoLdRkgowqPiwuh"], $GLOBALS["SHlRCNLzGtCGyHhhetLl"]);
        Configuration::updateValue($GLOBALS["ZjfFSusTFBIeqZzXPINl"], $GLOBALS["PJYmzfAXOgfQEzafjvBl"]);
        Configuration::updateValue($GLOBALS["FZUODXfvLjMLyWVrxINb"], $GLOBALS["EsvxraIFYmkdylZgGmMX"]);
        Configuration::updateValue($GLOBALS["TdRXiZXqEHgBuseUVqEz"], $GLOBALS["LdYUYYzSXzgfyUXDNKWg"]);
        Configuration::updateValue($GLOBALS["tTowgAFKukoxUTRKPRxI"], $GLOBALS["SHlRCNLzGtCGyHhhetLl"]);

        Configuration::updateValue($GLOBALS["lGWynakxWzWumZgCwVDV"], $GLOBALS["SHlRCNLzGtCGyHhhetLl"]);
        Configuration::updateValue($GLOBALS["JSWXjmnVIKELCLTICatu"], $GLOBALS["GTWxKNeocNBkgCRHHfJY"]);
        Configuration::updateValue($GLOBALS["OhaGrjJEvXfbGMPhtwAi"], $GLOBALS["fnGsWtXHbmMyXVDZPegk"]);
        Configuration::updateValue($GLOBALS["tNodlJSOgQKITyGtLBI"], $GLOBALS["RAtCBlhDFJOdHhPkM"]);
        Configuration::updateValue($GLOBALS["uWKFXgKiJnKuctSLxHZU"], $GLOBALS["djUHgAUBPKdarJcYpGng"]);

        return (parent::install() && $this->registerHook($GLOBALS["GGPikPaomBRwzmHgnBHE"]) && $this->registerHook($GLOBALS["igZOvvDlBZQywxZVIpEA"]) && $this->registerHook($GLOBALS["zhUvaCEjrllOIalDbnUv"]));
	}

	public function hookActionAdminControllerSetMedia()
	{
		$this->context->controller->addCSS($this->_path.$GLOBALS["gHJMNXPHqnNzVOGjUFmc"], $GLOBALS["kZQSYIKWnOeNngRGKIox"]);
	}

	public function hookActionFrontControllerSetMedia()
	{
		$this->context->controller->addCSS($this->_path.$GLOBALS["BEXrRczpGGDZJAJMnsjD"], $GLOBALS["kZQSYIKWnOeNngRGKIox"]);
	}

	public function hookDisplayHeader($params)
	{
		$_cart_discounts = $this->context->cart->getDiscounts();
		$is_mobi = Tools::getValue($GLOBALS["kILHyWrKplYlLeXaggxX"]);
		if($_cart_discounts && !$is_mobi) {
			foreach($_cart_discounts as $_discount) {
				if(isset($_discount[$GLOBALS["tWEpgXkrLAXowzZKvcbz"]]) && $_discount[$GLOBALS["tWEpgXkrLAXowzZKvcbz"]] == $GLOBALS["SHlRCNLzGtCGyHhhetLl"]) {
					$this->context->cart->deleteDiscount($_discount[$GLOBALS["bJVDJcBfjwWDhPgYNynR"]]);
			        unset($this->context->cookie->coupon);
			        unset($this->context->cookie->id_coupon);
				}
			}
		}
	}

    public function installModuleTab($tabClass, $tabName, $idTabParent)
    {
        $tab = new Tab();

        foreach (Language::getLanguages() as $language) {
            $tab->name[$language[$GLOBALS["waWafEeALmeXuRDBxZD"]]] = $tabName;
        }

        $tab->class_name = $tabClass;
        $tab->module = $this->name;
        $tab->id_parent = $idTabParent;

        if (!$tab->save()) {
            return false;
        }

        return $tab->id;
    }

	public function uninstall()
	{
		$sql = array();
		include(_PS_MODULE_DIR_.$this->name.'/sql/uninstall.php');
		foreach ($sql as $s) {
			if (!Db::getInstance()->execute($s))
			return false;
		}
           
        $tabsToDelete = array(
        	'AdminMobicommerce3',
        	'MCNewApp',
        	'MCManageApp',
        	'MCSocialLogin',
        	'MCCategoryWidget',
        	'MCLabels',
        	        	);

        foreach ($tabsToDelete as $className)
        {
        	$id_tab = (int)Tab::getIdFromClassName($className);
			if ($id_tab)
			{
				$tab = new Tab($id_tab);
				$tab->delete();
			}
        }

		if (!parent::uninstall())
			return false;

		return true;
	}

	public function getBaseUrl()
	{
		$base_url = _PS_BASE_URL_.__PS_BASE_URI__;
		if(Configuration::get($GLOBALS["tYnFWBeUsqckcNNWjtX"]) && Configuration::get($GLOBALS["POWdsDYcgiVnFFDSbMHA"]))
		{
			$base_url = str_replace($GLOBALS["JMxuLHVopMBOTWBgwTul"], $GLOBALS["DWmsYJsvcfBZEyObOnZU"], $base_url);
		}

		return $base_url;
	}
}
 ?>