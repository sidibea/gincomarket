<?php
$GLOBALS["DWmsYJsvcfBZEyObOnZU"]=base64_decode("aHR0cHM6Ly8=");$GLOBALS["JMxuLHVopMBOTWBgwTul"]=base64_decode("aHR0cDovLw==");$GLOBALS["POWdsDYcgiVnFFDSbMHA"]=base64_decode("UFNfU1NMX0VOQUJMRURfRVZFUllXSEVSRQ==");$GLOBALS["JxnebyjdFidXdVzNqnEb"]=base64_decode("Lw==");$GLOBALS["lleEQWghoHXfPPtBawwK"]=base64_decode("cmF0aW9f");$GLOBALS["YdhzFFiTsHZheiDjPLQW"]=base64_decode("cHJvZHVjdF90aHVtYm5haWxfdXJs");$GLOBALS["npjYrUmxXsOjHVoIGfVv"]=base64_decode("cHJvZHVjdF9pbWFnZV91cmw=");$GLOBALS["QtXGAQQggTtyJvIWmFWm"]=base64_decode("cHJvZHVjdF9zbWFsbF9pbWFnZV91cmw=");$GLOBALS["AfqiEYGiPLKtPpmIkWQa"]=base64_decode("cHJvZHVjdF9pbWFnZQ==");$GLOBALS["RMVPxNDRmOvlaTeGcDhG"]=base64_decode("dGh1bWJuYWlsX3VybA==");$GLOBALS["fqmNRQDiPSDlolhEWcsd"]=base64_decode("aW1hZ2VfdXJs");$GLOBALS["uDgJlAibwoXhqqJQgUbe"]=base64_decode("ZnVsbF9pbWFnZV91cmw=");$GLOBALS["VdgiCdagExNtYCmOeVI"]=base64_decode("YmFubmVyX3VybA==");$GLOBALS["VvQJrOROWpqQYDvaDgTO"]=base64_decode("d2lkZ2V0X2ltYWdl");$GLOBALS["pEgtGxQjesCRIrQjDIcE"]=base64_decode("L21vZHVsZXMvcHJvbW90aW9uL0Rpc2NvdW50LnBocA==");$GLOBALS["FkKzlSnVKCmyvzLqvusk"]=base64_decode("Y2xhc3MgS0Rpc2NvdW50");$GLOBALS["qDypvnhylytWIdshHmVg"]=base64_decode("L2NsYXNzXHMrRGlzY291bnRcdyov");$GLOBALS["fyVrKRJeQTlDbwcwiVU"]=base64_decode("a2M=");$GLOBALS["YpWsUqmZaBaUTqGUrItE"]=base64_decode("TU9CSUNPTU1FUkNFX0RJU0NPVU5UX0lE");$GLOBALS["wgJreVwAuJKiuarkNBo"]=base64_decode("SU5TRVJU");$GLOBALS["iKEQRFcfxIqznxtlsAQh"]=base64_decode("ZGlzY291bnQ=");$GLOBALS["IXUBPwEOJiRoYuyrKuqr"]=base64_decode("aWRfZGlzY291bnQ=");$GLOBALS["CkSDbeMfZsjquaHyePGy"]=base64_decode("TU9CSUNPTU1FUkNF");$GLOBALS["BoWuBfavKqJxeLgCuLA"]=base64_decode("bmFtZQ==");$GLOBALS["WhhfbVVjffUiUYQXixVQ"]=base64_decode("WS1tLWQgSDppOnM=");$GLOBALS["bAehMaUNHbcXoKGrFzk"]=base64_decode("ZGF0ZV8=");$GLOBALS["wHhXaULECqiacwaBpUAm"]=base64_decode("RmllbGQ=");$GLOBALS["bkllWKbpbDNtdZczDGer"]=base64_decode("Tk8=");$GLOBALS["TMViXTUNCFIQTtbawaNl"]=base64_decode("TnVsbA==");$GLOBALS["HKYqaGNIWSVcbLlOpspF"]=base64_decode("ZGlzY291bnRgIA==");$GLOBALS["lmzbXdMCGqOamuMKBXUt"]=base64_decode("REVTQyAgYA==");$GLOBALS["BZPtbZAdFNXrvqDqclyh"]=base64_decode("ZGlzY291bnRgIFdIRVJFIGBuYW1lYCA9ICdNT0JJQ09NTUVSQ0UnIA==");$GLOBALS["fbkNxoVNppCIaAEzxukT"]=base64_decode("U0VMRUNUIGBpZF9kaXNjb3VudGAgRlJPTSBg");$GLOBALS["ABSDjBsCmoZHGAucRECT"]=base64_decode("RGlzY291bnQucGhw");$GLOBALS["gCBcVkMUvTFsixROfxFa"]=base64_decode("Y291cG9uX2Zvcl9mcmVl");$GLOBALS["MRQIxgmVqcbETnEmOs"]=base64_decode("ZGlzY291bnRfYW1vdW50");$GLOBALS["feSiCyHZJEsqYvpXxAka"]=base64_decode("UFNfTEFOR19ERUZBVUxU");$GLOBALS["waWafEeALmeXuRDBxZD"]=base64_decode("aWRfbGFuZw==");$GLOBALS["srNEdryhNhBaZMOgnJxl"]=base64_decode("U3VibWl0Q3VycmVuY3k=");$GLOBALS["ncOdeHWWrEsiKLvRCvWd"]=base64_decode("ZGVjaW1hbHM=");$GLOBALS["siOBkNuGhovGPzJs"]=base64_decode("aXNvX2NvZGU=");$GLOBALS["bcMeQJBFBAERaPoJTbk"]=base64_decode("MS41");$GLOBALS["xlhZIDgKOCIUhPpCPieU"]=base64_decode("aWRfY3VycmVuY3k=");$GLOBALS["QwRYhAghWSBSwLZCRZVp"]=base64_decode("T05MWV9QUk9EVUNUU19XSVRIT1VUX1NISVBQSU5H");$GLOBALS["mxokwXFIHmHukTiPBGLB"]=base64_decode("T05MWV9XUkFQUElORw==");$GLOBALS["ecwUWldyoiRKfrumlxSi"]=base64_decode("T05MWV9TSElQUElORw==");$GLOBALS["UDFoAviVeNVmDbZKFqvv"]=base64_decode("Qk9USF9XSVRIT1VUX1NISVBQSU5H");$GLOBALS["OQvDkagnEaXBmqOCcQCU"]=base64_decode("Qk9USA==");$GLOBALS["QHUVsQjXpvCeBBbzFFHH"]=base64_decode("T05MWV9ESVNDT1VOVFM=");$GLOBALS["EzJEEUgawlqsIMlqznIK"]=base64_decode("T05MWV9QUk9EVUNUUw==");$GLOBALS["CNMiYbWtdcoNpSlRMxLS"]=base64_decode("MS40");$GLOBALS["CwAOPNYoEkLIqtNcoKVh"]=base64_decode("X1BTX0NVUlJFTkNZX0RFRkFVTFRf");$GLOBALS["vspbXwIRsnPwZowMnNrT"]=base64_decode("UFNfQ09VTlRSWV9ERUZBVUxU");$GLOBALS["SltlfKWWdbMeDxkcnpdz"]=base64_decode("X1BTX0NPVU5UUllfREVGQVVMVF8=");$GLOBALS["tugkmwKQmrdyfghQnRJj"]=base64_decode("");$GLOBALS["JomYlHrVurnUvBYpyhNg"]=base64_decode("UElDX05BTUVfU1VGRklY");$GLOBALS["OmuaIHhSxdHtPTVYKSzv"]=base64_decode("Z2V0Rm9ybWF0ZWROYW1l");$GLOBALS["YeyaVyBlDGHUhKbVHIlE"]=base64_decode("SW1hZ2VUeXBl");$GLOBALS["SnsSSwMKZSYeMFnEirnh"]=base64_decode("");$GLOBALS["zOnynVaOQuOFgONFTEzx"]=base64_decode("MTo=");
?><?php


init();


function init()
{
    $context = context::getContext();

    init_lanaguage();
    init_currency();
    init_promotion();

    if (method_exists($GLOBALS["YeyaVyBlDGHUhKbVHIlE"], $GLOBALS["OmuaIHhSxdHtPTVYKSzv"])) {
        define($GLOBALS["JomYlHrVurnUvBYpyhNg"], ImageType::getFormatedName($GLOBALS["tugkmwKQmrdyfghQnRJj"]));
    } else {
        define($GLOBALS["JomYlHrVurnUvBYpyhNg"], $GLOBALS["tugkmwKQmrdyfghQnRJj"]);
    }

    if (!defined($GLOBALS["SltlfKWWdbMeDxkcnpdz"]))
        define($GLOBALS["SltlfKWWdbMeDxkcnpdz"], Configuration::get($GLOBALS["vspbXwIRsnPwZowMnNrT"]));

    if (!defined($GLOBALS["CwAOPNYoEkLIqtNcoKVh"]))
        define($GLOBALS["CwAOPNYoEkLIqtNcoKVh"], Configuration::get($GLOBALS["CwAOPNYoEkLIqtNcoKVh"]));

    if (_PS_VERSION_ < $GLOBALS["CNMiYbWtdcoNpSlRMxLS"]) {
        define($GLOBALS["EzJEEUgawlqsIMlqznIK"], 1);
        define($GLOBALS["QHUVsQjXpvCeBBbzFFHH"], 2);
        define($GLOBALS["OQvDkagnEaXBmqOCcQCU"], 3);
        define($GLOBALS["UDFoAviVeNVmDbZKFqvv"], 4);
        define($GLOBALS["ecwUWldyoiRKfrumlxSi"], 5);
        define($GLOBALS["mxokwXFIHmHukTiPBGLB"], 6);
        define($GLOBALS["QwRYhAghWSBSwLZCRZVp"], 7);
    } else {
        define($GLOBALS["EzJEEUgawlqsIMlqznIK"], Cart::ONLY_PRODUCTS);
        define($GLOBALS["QHUVsQjXpvCeBBbzFFHH"], Cart::ONLY_DISCOUNTS);
        define($GLOBALS["OQvDkagnEaXBmqOCcQCU"], Cart::BOTH);
        define($GLOBALS["UDFoAviVeNVmDbZKFqvv"], Cart::BOTH_WITHOUT_SHIPPING);
        define($GLOBALS["ecwUWldyoiRKfrumlxSi"], Cart::ONLY_SHIPPING);
        define($GLOBALS["mxokwXFIHmHukTiPBGLB"], Cart::ONLY_WRAPPING);
        define($GLOBALS["QwRYhAghWSBSwLZCRZVp"], Cart::ONLY_PRODUCTS_WITHOUT_SHIPPING);
    }


    
    if ((int) $context->cookie->id_cart && $context->cart) {
        if (isset($context->cookie->id_carrier) && $context->cookie->id_carrier) {
            $context->cart->id_carrier = $context->cookie->id_carrier;           }
    }
}


function init_currency()
{
        $context = context::getContext();

    if (isset($context->cookie->id_currency)) {
        $id_currency = Tools::getValue($GLOBALS["xlhZIDgKOCIUhPpCPieU"]);
        if (intval($id_currency) && $context->cookie->id_currency != $id_currency) {
            $context->cookie->id_currency = $id_currency;
            _PS_VERSION_ > $GLOBALS["bcMeQJBFBAERaPoJTbk"] && $context->currency = new Currency($context->cookie->id_currency);
        }
    } else {
        $context->cookie->id_currency = _PS_CURRENCY_DEFAULT_;
    }
    $currency = Currency::getCurrency($context->cookie->id_currency);
    $context->cookie->currency = $currency[$GLOBALS["siOBkNuGhovGPzJs"]];
    $context->cookie->decimals = $currency[$GLOBALS["ncOdeHWWrEsiKLvRCvWd"]] * _PS_PRICE_DISPLAY_PRECISION_;

    unset($_POST[$GLOBALS["srNEdryhNhBaZMOgnJxl"]]);
    unset($_POST[$GLOBALS["xlhZIDgKOCIUhPpCPieU"]]);
}


function init_lanaguage()
{
    $context = context::getContext();

    if (isset($context->cookie->id_lang)) {
        $id_lang = Tools::getValue($GLOBALS["waWafEeALmeXuRDBxZD"]);
        if (intval($id_lang) && $context->cookie->id_lang != $id_lang) {
            $context->cookie->id_lang = $id_lang;
        }
    } else {
        $context->cookie->id_lang = (int) Configuration::get($GLOBALS["feSiCyHZJEsqYvpXxAka"]);
    }

    $context->cookie->iso = Language::getIsoById($context->cookie->id_lang);
    unset($_POST[$GLOBALS["waWafEeALmeXuRDBxZD"]]);
}

function init_promotion()
{
    $context = context::getContext();
    if (empty($_POST[$GLOBALS["MRQIxgmVqcbETnEmOs"]]) && (!isset($_POST[$GLOBALS["gCBcVkMUvTFsixROfxFa"]]) || $_POST[$GLOBALS["gCBcVkMUvTFsixROfxFa"]] <= 0)) {
        return false;
    } elseif (!is_readable(_PS_CLASS_DIR_ . $GLOBALS["ABSDjBsCmoZHGAucRECT"])) {
        return false;
    }

    $result = Db::getInstance()->getRow($GLOBALS["fbkNxoVNppCIaAEzxukT"] . _DB_PREFIX_ . $GLOBALS["BZPtbZAdFNXrvqDqclyh"]);
    if (!$result) {
        $rows = Db::getInstance()->ExecuteS($GLOBALS["lmzbXdMCGqOamuMKBXUt"] . _DB_PREFIX_ . $GLOBALS["HKYqaGNIWSVcbLlOpspF"]);
        $fields = array();
        foreach ($rows as $row) {
            if ($row[$GLOBALS["TMViXTUNCFIQTtbawaNl"]] == $GLOBALS["bkllWKbpbDNtdZczDGer"]) {
                if (strpos($row[$GLOBALS["wHhXaULECqiacwaBpUAm"]], $GLOBALS["bAehMaUNHbcXoKGrFzk"]) !== false) {
                    $fields[$row[$GLOBALS["wHhXaULECqiacwaBpUAm"]]] = date($GLOBALS["WhhfbVVjffUiUYQXixVQ"]);
                } else {
                    $fields[$row[$GLOBALS["wHhXaULECqiacwaBpUAm"]]] = 0;
                }
            }
        }
        $fields[$GLOBALS["BoWuBfavKqJxeLgCuLA"]] = $GLOBALS["CkSDbeMfZsjquaHyePGy"];
        unset($fields[$GLOBALS["IXUBPwEOJiRoYuyrKuqr"]]);
        if (Db::getInstance()->AutoExecute(_DB_PREFIX_ . $GLOBALS["iKEQRFcfxIqznxtlsAQh"], $fields, $GLOBALS["wgJreVwAuJKiuarkNBo"])) {
            $insert_id = Db::getInstance()->Insert_ID();
        } else {
            $insert_id = false;
        }
    } else {
        $insert_id = $result[$GLOBALS["IXUBPwEOJiRoYuyrKuqr"]];
    }

    if (!$insert_id) {
        return false;
    }

    defined($GLOBALS["YpWsUqmZaBaUTqGUrItE"], $insert_id);
    if (is_writeable(_PS_DOWNLOAD_DIR_)) {
        $dir = _PS_DOWNLOAD_DIR_;
    } else {
        $file = tempnam($GLOBALS["tugkmwKQmrdyfghQnRJj"], $GLOBALS["fyVrKRJeQTlDbwcwiVU"]);
        $dir = dirname($file) . DIRECTORY_SEPARATOR;
        @unlink($file);
    }

    if (!file_exists($dir . $GLOBALS["ABSDjBsCmoZHGAucRECT"])) {
        $context = Tools::file_get_contents(_PS_CLASS_DIR_ . $GLOBALS["ABSDjBsCmoZHGAucRECT"]);
        file_put_contents($dir . $GLOBALS["ABSDjBsCmoZHGAucRECT"], preg_replace($GLOBALS["qDypvnhylytWIdshHmVg"], $GLOBALS["FkKzlSnVKCmyvzLqvusk"], $context, 1));
    }

    if (!file_exists($dir . $GLOBALS["ABSDjBsCmoZHGAucRECT"])) {
        return false;
    }

    include_once $dir . $GLOBALS["ABSDjBsCmoZHGAucRECT"];
    include_once MOBICOMMERCE3_ROOT . $GLOBALS["pEgtGxQjesCRIrQjDIcE"];

    $cart = $context->cart;
    if ($insert_id && $cart->id) {
        if (!$cart->getDiscountsCustomer($insert_id)) {
            $cart->addDiscount((int) $insert_id);
            $cart->getDiscounts(false, true);         }
    }
}


function currency_price_value($price)
{
    $context = context::getContext();
    $price = Tools::convertPrice($price, Currency::getCurrent());
    return Tools::ps_round($price, $context->cookie->decimals);
}

function addImageRatio(&$product)
{
    $urls = array(
        'widget_image',
        'banner_url',
        'full_image_url',
        'image_url',
        'thumbnail_url',
        'product_image',
        'product_small_image_url',
        'product_image_url',
        'product_thumbnail_url'
        );

    foreach($urls as $_url) {
        if(isset($product[$_url])) {
            $product[$GLOBALS["lleEQWghoHXfPPtBawwK"].$_url] = getImageRatio($product[$_url]);
        }
    }

    return $product;
}

function getImageRatio($url)
{
    $width = 1;
    $height = 1;

    if(!empty($url)) {
        $base_url = getBaseUrl();
        $path = str_replace($base_url, _PS_ROOT_DIR_.$GLOBALS["JxnebyjdFidXdVzNqnEb"], $url);
        if(file_exists($path)) {
            list($width, $height, $type, $attr) = getimagesize($path);
        }
    }

    $ratio = round($height / $width, 2);
    return $GLOBALS["zOnynVaOQuOFgONFTEzx"].$ratio.$GLOBALS["SnsSSwMKZSYeMFnEirnh"];
}

function getBaseUrl()
{
    $base_url = _PS_BASE_URL_.__PS_BASE_URI__;
    $ssl = Configuration::get($GLOBALS["POWdsDYcgiVnFFDSbMHA"]);
    if($ssl)
    {
        $base_url = str_replace($GLOBALS["JMxuLHVopMBOTWBgwTul"], $GLOBALS["DWmsYJsvcfBZEyObOnZU"], $base_url);
    }

    return $base_url;
} ?>